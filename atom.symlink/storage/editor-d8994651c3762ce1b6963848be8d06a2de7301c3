{"mode":"editor","version":1,"windowDimensions":{"x":91,"y":28,"width":1440,"height":838,"maximized":false},"grammars":{"deserializer":"GrammarRegistry","grammarOverridesByPath":{}},"project":{"paths":["/Users/n4z4/lavoro/dockerized-php-dev"],"buffers":[{"text":"#!/bin/sh\n#\n# A control-script for managing the docker-infrastructure components\n\n# The first parameter is the action name\naction=$1\n\n# All other arguments are parameters\nif [ \"$#\" -gt \"1\" ]; then\nshift\nparameters=$@\nfi\n\n# Paths\nSCRIPTNAME=$(basename $0)\nSCRIPTPATH=$(readlink -f \"$0\" 2>/dev/null)\nif [ \"$?\" != 0 ]; then\n    if [ ! -f \"docker-compose.yml\" ]; then\n\t>&2 echo \" The $SCRIPTNAME-script will only work (on Mac OS) if you execute it from the project directory itself.\"\n\texit 1\n    fi\n    SCRIPTPATH=\"$(pwd -P)/$SCRIPTNAME\"\nfi\nPROJECTPATH=$(dirname \"$SCRIPTPATH\")\n\n# Switch into the project directory\ncd $PROJECTPATH\n\n# Mandatory Tools\nDOCKER=$(which docker)\nif [ -z \"$DOCKER\" ];\nthen\n    echo \"'docker' was not found on your system.\" >&2\n    exit 1\nfi\n\nDOCKERCOMPOSE=$(which docker-compose)\nif [ -z \"$DOCKERCOMPOSE\" ];\nthen\n    echo \"'docker-compose' was not found on your system.\" >&2\n    exit 1\nfi\n\n# Utils\nXARGS=$(which xargs)\nGREP=$(which grep)\nSED=$(which sed)\n\nDEVUSER=dockerdev\n\n#########################################################################\n# Get the full container name for the given container type (e.g. \"php\")\n# Arguments:\n#  CONTAINER_TYPE\n# Returns:\n#  The full name of the (first) container with the given type\n#########################################################################\ngetContainerNameByType() {\n    # abort if no type is specified\n    local CONTAINER_TYPE=\"$1\"\n    if [ -z \"$CONTAINER_TYPE\" ];\n    then\n        echo \"No container type specified. Please specifiy a container type (e.g. php, installer, mysql, nginx, ...).\"  >&2\n        return 1\n    fi\n\n    # check if xargs is available\n    if [ -z \"$XARGS\" ];\n    then\n        echo \"The tool 'xargs' was not found on your system.\" >&2\n        return 1\n    fi\n\n    # check if grep is available\n    if [ -z \"$GREP\" ];\n    then\n        echo \"The tool 'grep' was not found on your system.\" >&2\n        return 1\n    fi\n\n    # check if sed is available\n    if [ -z \"$SED\" ];\n    then\n        echo \"The tool 'sed' was not found on your system.\" >&2\n        return 1\n    fi\n\n    local containerName=$(\"$DOCKER\" ps -q | \"$XARGS\" $DOCKER inspect --format '{{.Name}}' | \"$GREP\" \"$CONTAINER_TYPE\" | \"$SED\" 's:/::' | \"$GREP\" \"$CONTAINER_TYPE_1\")\n    echo $containerName\n    return 0\n}\n\nexecuteComposer() {\n    local containerType=\"shell\"\n    local containerName=$(getContainerNameByType $containerType)\n    if [ -z \"$containerName\" ];\n    then\n        echo \"Cannot determine the name of the container.\" >&2\n        return 1\n    fi\n\n    \"$DOCKER\" exec -u \"$DEVUSER\" $containerName composer --working-dir=\"/var/www/html\" $@\n    return 0\n}\n\nenterContainer() {\n    local containerType=\"$1\"\n    if [ -z \"$containerType\" ];\n    then\n        echo \"No container type specified. Please specifiy a container type (e.g. php, installer, mysql, nginx, ...).\"  >&2\n        return 1\n    fi\n\n    local containerName=$(getContainerNameByType $containerType)\n    if [ -z \"$containerName\" ];\n    then\n        echo \"Cannot determine the name of the container.\" >&2\n        return 1\n    fi\n\n    \"$DOCKER\" exec -u \"$DEVUSER\" -ti $containerName bash\n    return 0\n}\n\nstart() {\n    \"$DOCKERCOMPOSE\" up -d && \"$DOCKERCOMPOSE\" logs\n}\n\nstop() {\n    \"$DOCKERCOMPOSE\" stop\n}\n\nrestart() {\n    \"$DOCKERCOMPOSE\" restart\n}\n\nstatus() {\n    \"$DOCKERCOMPOSE\" ps\n}\n\nstats() {\n    # check if sed is available\n    if [ -z \"$SED\" ];\n    then\n        echo \"Stats requires 'sed'. The tool was not found on your system.\" >&2\n        return 1\n    fi\n\n    \"$DOCKER\" ps -q | \"$XARGS\" \"$DOCKER\" inspect --format '{{.Name}}' | \"$SED\" 's:/::' | \"$XARGS\" \"$DOCKER\" stats\n}\n\ncomposer() {\n    executeComposer $parameters\n}\n\nenter() {\n    enterContainer $parameters\n}\n\ndestroy() {\n    \"$DOCKERCOMPOSE\" stop\n    \"$DOCKERCOMPOSE\" rm --force\n}\n\ncase \"$action\" in\n    start)\n    start\n    ;;\n\n    stop)\n    stop\n    ;;\n\n    restart)\n    restart\n    ;;\n\n    status)\n    status\n    ;;\n\n    stats)\n    stats\n    ;;\n\n    composer)\n    composer\n    ;;\n\n    enter)\n    enter\n    ;;\n\n    destroy)\n    destroy\n    ;;\n\n    *)\n    echo \"usage : $0 start|stop|restart|status|stats|composer|enter|destroy\n\n  start      Starts the docker containers\n  stop       Stops all docker containers\n  restart    Restarts all docker containers\n  status     Prints the status of all docker containers\n  stats      Displays live resource usage statistics of all containers\n  composer   Executes composer in the magento root directory\n  enter      Enters the bash of a given container type (e.g. php, mysql)\n  destroy    Stops all containers and removes all data\n\"\n    ;;\nesac\n\nexit 0\n","markerStore":{"nextMarkerId":3,"markersById":{"0":{"range":{"start":{"row":0,"column":0},"end":{"row":0,"column":0}},"properties":{"type":"selection","editorId":28},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true},"2":{"range":{"start":{"row":87,"column":0},"end":{"row":88,"column":0}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"never","maintainHistory":false}},"version":2},"history":{"version":3,"nextCheckpointId":1,"undoStack":[],"redoStack":[]},"encoding":"utf8","filePath":"/Users/n4z4/lavoro/dockerized-php-dev/container.sh","digestWhenLastPersisted":"1e261cb0ca62f0d3ec158eaff3d6d5d817ac0eee","preferredLineEnding":null,"deserializer":"TextBuffer","version":2},{"text":"##########################\n##  Data only container ##\n##########################\n\nFROM debian:jessie\n\nCMD [\"true\"]\n","markerStore":{"nextMarkerId":1,"markersById":{"0":{"range":{"start":{"row":0,"column":0},"end":{"row":0,"column":0}},"properties":{"type":"selection","editorId":40},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}},"version":2},"history":{"version":3,"nextCheckpointId":1,"undoStack":[],"redoStack":[]},"encoding":"utf8","filePath":"/Users/n4z4/lavoro/dockerized-php-dev/docker-images/data/Dockerfile","digestWhenLastPersisted":"7110e3bc40fca6aee6975e4b4ebcc26bd79dee5b","preferredLineEnding":null,"deserializer":"TextBuffer","version":2},{"text":"#!/usr/bin/env bash\n\nexport ORIGPASSWD=$(cat /etc/passwd | grep dockerdev)\nexport ORIG_UID=$(echo $ORIGPASSWD | cut -f3 -d:)\nexport ORIG_GID=$(echo $ORIGPASSWD | cut -f4 -d:)\n\nexport DEV_UID=${DEV_UID:=$ORIG_UID}\nexport DEV_GID=${DEV_GID:=$ORIG_GID}\n\nexport ORIG_HOME=$(echo $ORIGPASSWD | cut -f6 -d:)\n\nsed -i -e \"s/:$ORIG_UID:$ORIG_GID:/:$DEV_UID:$DEV_GID:/\" /etc/passwd\nsed -i -e \"s/dockerdev:x:$ORIG_GID:/dockerdev:x:$DEV_GID:/\" /etc/group\n\nusermod -u \"$DEV_UID\" dockerdev\nusermod -g \"$DEV_GID\" dockerdev\n\nchown -R dockerdev:dockerdev $ORIG_HOME\n\nsu - dockerdev\n","markerStore":{"nextMarkerId":1,"markersById":{"0":{"range":{"start":{"row":0,"column":0},"end":{"row":0,"column":0}},"properties":{"type":"selection","editorId":44},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}},"version":2},"history":{"version":3,"nextCheckpointId":1,"undoStack":[],"redoStack":[]},"encoding":"utf8","filePath":"/Users/n4z4/lavoro/dockerized-php-dev/docker-images/installer/bin/entrypoint.sh","digestWhenLastPersisted":"5b6bff54d5d4813962383f5fd7a5e9769072614e","preferredLineEnding":null,"deserializer":"TextBuffer","version":2},{"text":"<?php phpinfo(); ?>\n","markerStore":{"nextMarkerId":1,"markersById":{"0":{"range":{"start":{"row":0,"column":0},"end":{"row":0,"column":0}},"properties":{"type":"selection","editorId":48},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}},"version":2},"history":{"version":3,"nextCheckpointId":1,"undoStack":[],"redoStack":[]},"encoding":"utf8","filePath":"/Users/n4z4/lavoro/dockerized-php-dev/src/index.php","digestWhenLastPersisted":"ac638cc38f011b74a8d9a4e7d3d60358e472166c","preferredLineEnding":null,"deserializer":"TextBuffer","version":2},{"text":"{\n  \"name\": \"stefanorg/dockerized-php-dev\",\n  \"description\": \"Dockerized php dev with zray\",\n  \"license\": \"BSD-3-Clause\",\n  \"homepage\": \"https://github.com/stefanorg/dockerized-php-dev\"\n}\n","markerStore":{"nextMarkerId":5,"markersById":{"0":{"range":{"start":{"row":0,"column":0},"end":{"row":0,"column":0}},"properties":{"type":"selection","editorId":52},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true},"3":{"range":{"start":{"row":0,"column":0},"end":{"row":0,"column":1}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"overlap","maintainHistory":false},"4":{"range":{"start":{"row":5,"column":0},"end":{"row":5,"column":1}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"overlap","maintainHistory":false}},"version":2},"history":{"version":3,"nextCheckpointId":1,"undoStack":[],"redoStack":[]},"encoding":"utf8","filePath":"/Users/n4z4/lavoro/dockerized-php-dev/composer.json","digestWhenLastPersisted":"3ff9b8413f1307bf2f2e316cf8717782b81cec45","preferredLineEnding":null,"deserializer":"TextBuffer","version":2},{"text":"workspace:\n  build: docker-images/data\n  extends:\n    file: docker-compose.local.yml\n    service: workspace_container\n\nshell:\n  build: docker-images/installer\n  privileged: true\n  command: /bin/zsh\n  user: dockerdev\n  volumes_from:\n      - workspace\n  environment:\n      # USER ID of your host user default to 1000 (boot2docker)\n      # DEV_UID: 502\n      # GID of your host user default to 20 (boot2docker)\n      # DEV_GID: 20\n\nmysql:\n  image: mysql:latest\n  ports:\n    - \"3306:3306\"\n  volumes_from:\n    - workspace\n  environment:\n    MYSQL_DATABASE: appdb\n    MYSQL_USER: app_dbuser\n    MYSQL_PASSWORD: app_dbpwd\n    MYSQL_ROOT_PASSWORD: MYROOTPWD\n\nphp:\n  build: docker-images/php/5.6-dev\n  ports:\n      #web port\n      - \"80:80\"\n      #zray port\n      - \"10081:10081\"\n  links:\n      - mysql\n  volumes_from:\n      - workspace\n  privileged: true\n  environment:\n      # USER ID of your host user default to 1000 (boot2docker)\n      # DEV_UID: 502\n      # GID of your host user default to 20 (boot2docker)\n      # DEV_GID: 20\n      BASE_URL: http://app.dev.local\n      APPLICATION_ENV: development\n","markerStore":{"nextMarkerId":20,"markersById":{"0":{"range":{"start":{"row":17,"column":19},"end":{"row":17,"column":19}},"properties":{"type":"selection","editorId":56,"goalScreenRange":null,"autoscroll":false},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true},"15":{"range":{"start":{"row":10,"column":0},"end":{"row":10,"column":0}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"never","maintainHistory":false},"16":{"range":{"start":{"row":15,"column":0},"end":{"row":16,"column":0}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"never","maintainHistory":false},"17":{"range":{"start":{"row":17,"column":0},"end":{"row":18,"column":0}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"never","maintainHistory":false},"18":{"range":{"start":{"row":45,"column":0},"end":{"row":46,"column":0}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"never","maintainHistory":false},"19":{"range":{"start":{"row":47,"column":0},"end":{"row":49,"column":0}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"never","maintainHistory":false}},"version":2},"history":{"version":3,"nextCheckpointId":23,"undoStack":[{"type":"group-start","snapshot":{"0":{"range":[[11,0],[12,15]],"properties":{"type":"selection","editorId":56,"goalScreenRange":null},"reversed":true,"tailed":true,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"change","content":{"oldRange":[[11,0],[12,15]],"newRange":[[11,0],[11,0]],"oldText":"  # links:\n  #     - mysql","newText":""}},{"type":"change","content":{"oldRange":[[10,17],[11,0]],"newRange":[[10,17],[10,17]],"oldText":"\n","newText":""}},{"type":"group-end","snapshot":{"0":{"range":[[10,17],[10,17]],"properties":{"type":"selection","editorId":56,"goalScreenRange":null},"reversed":true,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"group-start","snapshot":{"0":{"range":[[48,23],[48,30]],"properties":{"type":"selection","editorId":56,"goalScreenRange":null,"autoscroll":false},"reversed":false,"tailed":true,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"change","content":{"oldRange":[[48,23],[48,30]],"newRange":[[48,23],[48,24]],"oldText":"namaste","newText":"a"}},{"type":"change","content":{"oldRange":[[48,24],[48,24]],"newRange":[[48,24],[48,25]],"oldText":"","newText":"p"}},{"type":"change","content":{"oldRange":[[48,25],[48,25]],"newRange":[[48,25],[48,26]],"oldText":"","newText":"p"}},{"type":"group-end","snapshot":{"0":{"range":[[48,26],[48,26]],"properties":{"type":"selection","editorId":56,"goalScreenRange":null,"autoscroll":false},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"group-start","snapshot":{"0":{"range":[[45,18],[45,18]],"properties":{"type":"selection","editorId":56,"goalScreenRange":null,"autoscroll":false},"reversed":false,"tailed":true,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"change","content":{"oldRange":[[45,6],[45,6]],"newRange":[[45,6],[45,8]],"oldText":"","newText":"# "}},{"type":"group-end","snapshot":{"0":{"range":[[45,20],[45,20]],"properties":{"type":"selection","editorId":56,"goalScreenRange":null,"autoscroll":false},"reversed":false,"tailed":true,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"group-start","snapshot":{"0":{"range":[[47,17],[47,17]],"properties":{"type":"selection","editorId":56,"goalScreenRange":null,"autoscroll":false},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"change","content":{"oldRange":[[47,6],[47,6]],"newRange":[[47,6],[47,8]],"oldText":"","newText":"# "}},{"type":"group-end","snapshot":{"0":{"range":[[47,19],[47,19]],"properties":{"type":"selection","editorId":56,"goalScreenRange":null,"autoscroll":false},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"group-start","snapshot":{"0":{"range":[[15,18],[15,18]],"properties":{"type":"selection","editorId":56,"goalScreenRange":null,"autoscroll":false},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"change","content":{"oldRange":[[15,6],[15,6]],"newRange":[[15,6],[15,8]],"oldText":"","newText":"# "}},{"type":"group-end","snapshot":{"0":{"range":[[15,20],[15,20]],"properties":{"type":"selection","editorId":56,"goalScreenRange":null,"autoscroll":false},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"group-start","snapshot":{"0":{"range":[[17,17],[17,17]],"properties":{"type":"selection","editorId":56,"goalScreenRange":null,"autoscroll":false},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"change","content":{"oldRange":[[17,6],[17,6]],"newRange":[[17,6],[17,8]],"oldText":"","newText":"# "}},{"type":"group-end","snapshot":{"0":{"range":[[17,19],[17,19]],"properties":{"type":"selection","editorId":56,"goalScreenRange":null,"autoscroll":false},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}}],"redoStack":[]},"encoding":"utf8","filePath":"/Users/n4z4/lavoro/dockerized-php-dev/docker-compose.yml","digestWhenLastPersisted":"3116a39058c0fe8fbc19b4a74f682b7984cd039b","preferredLineEnding":null,"deserializer":"TextBuffer","version":2}],"deserializer":"Project"},"workspace":{"paneContainer":{"root":{"id":3,"items":[{"id":28,"softTabs":true,"displayBuffer":{"id":29,"softWrapped":false,"scrollTop":3963,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/n4z4/lavoro/dockerized-php-dev/container.sh","largeFileMode":false,"deserializer":"TokenizedBuffer"},"largeFileMode":false,"deserializer":"DisplayBuffer"},"deserializer":"TextEditor"},{"id":40,"softTabs":true,"displayBuffer":{"id":41,"softWrapped":false,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/n4z4/lavoro/dockerized-php-dev/docker-images/data/Dockerfile","largeFileMode":false,"deserializer":"TokenizedBuffer"},"largeFileMode":false,"deserializer":"DisplayBuffer"},"deserializer":"TextEditor"},{"id":44,"softTabs":true,"displayBuffer":{"id":45,"softWrapped":false,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/n4z4/lavoro/dockerized-php-dev/docker-images/installer/bin/entrypoint.sh","largeFileMode":false,"deserializer":"TokenizedBuffer"},"largeFileMode":false,"deserializer":"DisplayBuffer"},"deserializer":"TextEditor"},{"id":48,"softTabs":true,"displayBuffer":{"id":49,"softWrapped":false,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/n4z4/lavoro/dockerized-php-dev/src/index.php","largeFileMode":false,"deserializer":"TokenizedBuffer"},"largeFileMode":false,"deserializer":"DisplayBuffer"},"deserializer":"TextEditor"},{"id":52,"softTabs":true,"displayBuffer":{"id":53,"softWrapped":false,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/n4z4/lavoro/dockerized-php-dev/composer.json","largeFileMode":false,"deserializer":"TokenizedBuffer"},"largeFileMode":false,"deserializer":"DisplayBuffer"},"deserializer":"TextEditor"},{"id":56,"softTabs":true,"displayBuffer":{"id":57,"softWrapped":false,"scrollTop":362,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/n4z4/lavoro/dockerized-php-dev/docker-compose.yml","largeFileMode":false,"deserializer":"TokenizedBuffer"},"largeFileMode":false,"deserializer":"DisplayBuffer"},"deserializer":"TextEditor"}],"activeItemURI":"/Users/n4z4/lavoro/dockerized-php-dev/docker-compose.yml","focused":false,"flexScale":1,"deserializer":"Pane"},"activePaneId":3,"deserializer":"PaneContainer","version":1},"fullScreen":false,"packagesWithActiveGrammars":["language-shellscript","language-php","language-html","language-json","language-yaml","language-hyperlink","language-todo"],"deserializer":"Workspace"},"packageStates":{"fuzzy-finder":{"/Users/n4z4/lavoro/dockerized-php-dev/container.sh":1446116152306,"/Users/n4z4/lavoro/dockerized-php-dev/docker-images/data/Dockerfile":1446116158294,"/Users/n4z4/lavoro/dockerized-php-dev/docker-images/installer/bin/entrypoint.sh":1446116161428,"/Users/n4z4/lavoro/dockerized-php-dev/src/index.php":1446116165488,"/Users/n4z4/lavoro/dockerized-php-dev/composer.json":1446116169992,"/Users/n4z4/lavoro/dockerized-php-dev/docker-compose.yml":1446116174237},"keybinding-resolver":{},"tabs":[{}],"tree-view":{"directoryExpansionStates":{"/Users/n4z4/lavoro/dockerized-php-dev":{"isExpanded":true,"entries":{".git":{"isExpanded":false,"entries":{}},"docker-images":{"isExpanded":false,"entries":{}},"src":{"isExpanded":false,"entries":{}},"var":{"isExpanded":true,"entries":{"lib":{"isExpanded":false,"entries":{}}}}}}},"selectedPath":"/Users/n4z4/lavoro/dockerized-php-dev/docker-compose.yml","hasFocus":false,"attached":true,"scrollLeft":0,"scrollTop":0,"width":335},"find-and-replace":{"findOptions":{"findPattern":"exec","replacePattern":"exec -u \"$DEVUSER\"","pathsPattern":"","useRegex":false,"wholeWord":false,"caseSensitive":true,"inCurrentSelection":false},"findHistory":["/var/www/app","XARGS","$XARGS","$GREP","SED","$SED","DOCKERCOMPOSE","$DOCKERCOMPOSE","$DOCKER","exec"],"replaceHistory":["/var/www/html","\"$XARGS\"","\"$GREP\"","\"$SED\"","\"$DOCKERCOMPOSE\"","\"$DOCKER\"","exec -u \"$DEVUSER\""],"pathsHistory":["/var/www/html","\"$XARGS\"","\"$GREP\"","\"$SED\"","\"$DOCKERCOMPOSE\"","\"$DOCKER\"","exec -u \"$DEVUSER\""]}}}