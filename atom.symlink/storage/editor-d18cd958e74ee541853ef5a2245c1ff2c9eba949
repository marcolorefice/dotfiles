{"mode":"editor","version":1,"windowDimensions":{"x":0,"y":23,"width":1440,"height":838,"maximized":false},"grammars":{"deserializer":"GrammarRegistry","grammarOverridesByPath":{}},"project":{"paths":["/Users/n4z4/Downloads/class.phpmailer"],"buffers":[{"text":"<?\r\nif (!function_exists('inviamail')) { \r\nrequire (\"procedureweb/PHPclasses/class.phpmailer.php\");\r\nfunction inviamail ($mittente,$mittente_nome,$destinatario,$destinatario_nome,$destinatariocc,$destinatario_nomecc,$password,$oggetto,$testo,$percorso='',$allegati=array(),$conferma = '',$identificativo,$immagine) {\r\n$mail = new PHPMailer();\r\n$mail->From = \"\"; //indirizzo email mittente predefinito\r\nif ($mittente !== \"\") $mail->From = $mittente; \r\n$mail->FromName = $mittente_nome; \r\n\r\n\r\n    \r\n$mail->Host     = \"mail.vigilfuoco.it\"; // your SMTP Server\r\n$mail->Mailer   = \"smtp\"; // SMTP Method\r\n$mail->SMTPAuth = true;  // Auth Type\r\n$mail->Username = \"\"; //username\r\n$mail->Password = \"\"; //password\r\n$mail->AddReplyTo($mittente);\r\n$mail->Subject = $oggetto;\r\n$mail->IsHTML(true);\r\n$mail->Body = $testo.$immagine;\r\n\r\nif ($conferma == \"S\") $mail->ConfirmReadingTo = \"\"; //indirizzo conferma lettura\r\n\r\n$mail->AddAddress($destinatario,$destinatario_nome);\r\nif ($destinatariocc !== \"\") $mail->AddCC($destinatariocc,$destinatario_nomecc);\r\n\r\n    \r\nif (count($allegati) > 0) {\r\n    foreach ($allegati as $key => $value) {\r\n    $file = ($percorso !== \"\" ? $percorso.\"/\" : \"\").$value;\r\n    if (file_exists($file)) { \r\n    $mail->AddAttachment($file); \r\n    //$testo = \"<font size=2 color=red>MESSAGGIO SALVATO AUTOMATICAMENTE SUL SERVER<br><br>Inviato in allegato il file : <b><i>\".$value.\"</b></i> (non incluso in questa e-mail stampata)</font><br><br>\".$testo;\r\n    }\r\n   } \r\n}\r\n\r\n\r\n//$invio = $mail->Send().$mail->ErrorInfo;\r\n$risultato = $mail->Send();\r\nif ($risultato) {\r\n$dmy=date(\"d-M-Y H:i:s\"); \r\n$dmy.= \" +0100\"; // Had to do this bit manually as server and me are in different timezones \r\n//$stream = @imap_open(\"{mail.vigilfuoco.it:143/notls}Inviate\", $mittente, $password);\r\n\r\n$boundary = \"------=\".md5(uniqid(rand())); \r\n\r\n\r\nif (count($allegati) > 0) {\r\n$testo .= \"<br><table border=1 width=50%>\";\r\n$testo .= \"<tr><td><font size=1><b>Percorso<td><font size=1><b>Nome File\";\r\n    foreach ($allegati as $key => $value) {\r\n$testo .= \"<tr><td><font size=1>\".$percorso.\"<td><font size=1>\".$value;\r\n    }\r\n    }\r\n$msg = (\"From: \".$mittente.\"\\r\\n\" \r\n        . \"To: \".$destinatario.\"\\r\\n\" \r\n        . \"Date: $dmy\\r\\n\" \r\n        . \"Subject: \".$oggetto.\"\\r\\n\" \r\n        . \"MIME-Version: 1.0\\r\\n\" \r\n        . \"Content-Type: multipart/mixed; boundary=\\\"$boundary\\\"\\r\\n\" \r\n        . \"\\r\\n\\r\\n\" \r\n        . \"--$boundary\\r\\n\" \r\n        . \"Content-Type: text/html;\\r\\n\\tcharset=\\\"ISO-8859-1\\\"\\r\\n\" \r\n        . \"Content-Transfer-Encoding: 8bit \\r\\n\" \r\n        . \"\\r\\n\\r\\n\" \r\n        . $testo.\"\\r\\n\" \r\n        . \"\\r\\n\\r\\n\");\r\nif ($identificativo <> 0 && $identificativo !== \"\")  { \r\n\r\n// con il $msg ci puoi fare un file .eml x conferma di invio!!!!\r\n\r\n}\r\n} \r\n$mail->ClearAddresses(); \r\nreturn ($risultato.$mail->ErrorInfo);\r\n}\r\n}\r\n?>","markerStore":{"nextMarkerId":1,"markersById":{"0":{"range":{"start":{"row":0,"column":0},"end":{"row":0,"column":0}},"properties":{"type":"selection","editorId":8,"goalScreenRange":null},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}},"version":2},"history":{"version":3,"nextCheckpointId":1,"undoStack":[],"redoStack":[]},"encoding":"utf8","filePath":"/Users/n4z4/Downloads/class.phpmailer/funzione.php","digestWhenLastPersisted":"ea86763dfef0e310600606dbd921cbd75cb37223","preferredLineEnding":null,"deserializer":"TextBuffer","version":2}],"deserializer":"Project"},"workspace":{"paneContainer":{"root":{"id":3,"items":[{"id":8,"softTabs":true,"displayBuffer":{"id":9,"softWrapped":false,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/n4z4/Downloads/class.phpmailer/funzione.php","largeFileMode":false,"deserializer":"TokenizedBuffer"},"largeFileMode":false,"deserializer":"DisplayBuffer"},"deserializer":"TextEditor"}],"activeItemURI":"/Users/n4z4/Downloads/class.phpmailer/funzione.php","focused":true,"flexScale":1,"deserializer":"Pane"},"activePaneId":3,"deserializer":"PaneContainer","version":1},"fullScreen":false,"packagesWithActiveGrammars":["language-php","language-html","language-hyperlink","language-todo"],"deserializer":"Workspace"},"packageStates":{"fuzzy-finder":{"/Users/n4z4/Downloads/class.phpmailer/funzione.php":1445456197206},"tabs":[{}],"tree-view":{"directoryExpansionStates":{"/Users/n4z4/Downloads/class.phpmailer":{"isExpanded":true,"entries":{}}},"selectedPath":"/Users/n4z4/Downloads/class.phpmailer/funzione.php","hasFocus":false,"attached":true,"scrollLeft":0,"scrollTop":0,"width":200}}}