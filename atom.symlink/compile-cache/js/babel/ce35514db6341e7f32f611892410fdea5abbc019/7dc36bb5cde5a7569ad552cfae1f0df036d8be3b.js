Object.defineProperty(exports, '__esModule', {
	value: true
});

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

/** @babel */

var _commandsGenerate = require('./commands/generate');

var _commandsGenerate2 = _interopRequireDefault(_commandsGenerate);

var _commandsShow = require('./commands/show');

var _commandsShow2 = _interopRequireDefault(_commandsShow);

var _commandsFix = require('./commands/fix');

var _commandsFix2 = _interopRequireDefault(_commandsFix);

var lazyReq = require('lazy-req')(require);

var atm = lazyReq('atom');

var statusTile = lazyReq('./lib/statustile-view');
var wrapGuide = lazyReq('./lib/wrapguide-view');
var editorconfig = lazyReq('editorconfig');

var STATES = ['subtle', 'success', 'info', 'warning', 'error'];

// Holds all **blacklisted** packages and the properties we assume are affected by them
// 'packagename': [properties]
var BLACKLISTED_PACKAGES = {
	whitespace: ['insert_final_newline', 'trim_trailing_whitespace']
};

// Sets the state of the embedded editorconfig
// This includes the severity (info, warning..) as well as the notification-messages for users
function setState(ecfg) {
	var messages = [];
	var statcon = 0;

	// Check if any editorconfig-setting is in use
	if (Object.keys(ecfg.settings).reduce(function (prev, curr) {
		return ecfg.settings[curr] !== 'auto' || prev;
	}, false)) {
		statcon = Math.max(statcon, 1);
	}

	// Check the 'Tab Type'-setting
	if (ecfg.settings.indent_style !== 'auto' && atom.config.get('editor.tabType') !== 'auto') {
		var tabType = atom.config.get('editor.tabType');

		messages.push('**Tab Type:** You editor\'s configuration setting "Tab Type"\n\t\t(currently "' + tabType + '" prevents the editorconfig-property `indent_style` from working.\n\t\t@"Tab Type" **must** be set to "auto" to fix this issue.');

		statcon = Math.max(statcon, 4);
	}

	// Check for BLACKLISTED packages
	var suspiciuousPackages = {};
	var affectedProperties = undefined;
	for (var packageName in BLACKLISTED_PACKAGES) {
		if (({}).hasOwnProperty.call(BLACKLISTED_PACKAGES, packageName)) {
			affectedProperties = BLACKLISTED_PACKAGES[packageName].filter(function (prop) {
				return ecfg.settings[prop] !== 'auto';
			});
			if (affectedProperties.length > 0 && atom.packages.isPackageActive(packageName)) {
				suspiciuousPackages[packageName] = affectedProperties;
			}
		}
	}
	if (Object.keys(suspiciuousPackages).length > 0) {
		for (var packageName in suspiciuousPackages) {
			if (({}).hasOwnProperty.call(suspiciuousPackages, packageName)) {
				var properties = suspiciuousPackages[packageName];
				messages.push('**' + packageName + ':** It is likely that the\n\t\t\t\t' + packageName + '-package prevents the following\n\t\t\t\tpropert' + (properties.length > 1 ? 'ies' : 'y') + ' from working reliably:\n\t\t\t\t`' + properties.join('`, `') + '`.@You may deactivate or disable the ' + packageName + '-package\n\t\t\t\tto fix that issue.');
			}
		}
		statcon = Math.max(statcon, 3);
	}

	switch (statcon) {
		case 1:
			messages.push('The editorconfig was applied successfully and the editor for this file\n\t\t\tshould work as expected. If you face any unexpected behavior please report us the issue.\n\t\t\t♥️');
			break;
		case 0:
			messages.push('For this file were no editorconfig-settings applied.');
			break;
		default:
			break;
	}

	// Apply changes
	ecfg.messages = messages;
	ecfg.state = STATES[statcon];
	statusTile().updateIcon(ecfg.state);
}

// Initializes the (into the TextBuffer-instance) embedded editorconfig-object
function initializeTextBuffer(buffer) {
	if ('editorconfig' in buffer === false) {
		buffer.editorconfig = {
			buffer: buffer, // preserving a reference to the parent TextBuffer
			disposables: new (atm().CompositeDisposable)(),
			state: 'subtle',
			settings: {
				trim_trailing_whitespace: 'auto', // eslint-disable-line camelcase
				insert_final_newline: 'auto', // eslint-disable-line camelcase
				max_line_length: 'auto', // eslint-disable-line camelcase
				end_of_line: 'auto', // eslint-disable-line camelcase
				indent_style: 'auto', // eslint-disable-line camelcase
				tab_width: 'auto', // eslint-disable-line camelcase
				charset: 'auto' // eslint-disable-line camelcase
			},

			// Sets the given package active or inactive
			setPackageState: function setPackageState(name, active) {
				if (atom.packages.isPackageDisabled(name) === false && atom.packages.isPackageActive(name) !== active) {
					if (active === true) {
						atom.packages.activatePackage(name);
					} else {
						atom.packages.deactivatePackage(name);
					}
				}
			},

			// Applies the settings to the buffer and the corresponding editor
			applySettings: function applySettings() {
				var editor = atom.workspace.getTextEditors().reduce(function (prev, curr) {
					return curr.getBuffer() === buffer && curr || prev;
				}, undefined);
				if (!editor) {
					return;
				}

				var configOptions = { scope: editor.getRootScopeDescriptor() };
				var settings = this.settings;

				if (editor && editor.getBuffer() === buffer) {
					if (settings.indent_style === 'auto') {
						editor.setSoftTabs(atom.config.get('editor.softTabs', configOptions));
					} else {
						editor.setSoftTabs(settings.indent_style === 'space');
					}

					if (settings.tab_width === 'auto') {
						editor.setTabLength(atom.config.get('editor.tabLength', configOptions));
					} else {
						editor.setTabLength(settings.tab_width);
					}

					if (settings.charset === 'auto') {
						buffer.setEncoding(atom.config.get('core.fileEncoding', configOptions));
					} else {
						buffer.setEncoding(settings.charset);
					}

					// max_line_length-settings
					var editorParams = {};
					if (settings.max_line_length === 'auto') {
						editorParams.softWrapped = atom.config.get('editor.softWrap', configOptions);
						editorParams.softWrapAtPreferredLineLength = atom.config.get('editor.softWrapAtPreferredLineLength', configOptions);
						editorParams.preferredLineLength = atom.config.get('editor.preferredLineLength', configOptions);
					} else {
						editorParams.softWrapped = true;
						editorParams.softWrapAtPreferredLineLength = true;
						editorParams.preferredLineLength = settings.max_line_length;
					}

					// Update the editor-properties
					editor.update(editorParams);

					// Ensure the wrap-guide is set properly
					if (this.wrapGuide === undefined) {
						this.wrapGuide = new (wrapGuide())();
						this.wrapGuide.initialize(editor, atom.views.getView(editor));
					}
					this.wrapGuide.update();
					// Toggle the wrap-guide package if necessary
					this.setPackageState('wrap-guide', this.wrapGuide.isVisible() === false);

					if (settings.end_of_line !== 'auto') {
						buffer.setPreferredLineEnding(settings.end_of_line);
					}
				}
				setState(this);
			},

			// onWillSave-Event-Handler
			// Trims whitespaces and inserts/strips final newline before saving
			onWillSave: function onWillSave() {
				var settings = this.settings;

				if (settings.trim_trailing_whitespace === true) {
					// eslint-disable-next-line max-params
					buffer.backwardsScan(/[ \t]+$/gm, function (params) {
						if (params.match[0].length > 0) {
							params.replace('');
						}
					});
				}

				if (settings.insert_final_newline !== 'auto') {
					var lastRow = buffer.getLineCount() - 1;

					if (buffer.isRowBlank(lastRow)) {
						var stripStart = buffer.previousNonBlankRow(lastRow);

						if (settings.insert_final_newline === true) {
							stripStart += 1;
						}
						// Strip empty lines from the end
						if (stripStart < lastRow) {
							buffer.deleteRows(stripStart + 1, lastRow);
						}
					} else if (settings.insert_final_newline === true) {
						buffer.append('\n');
					}
				}
			}
		};

		buffer.editorconfig.disposables.add(buffer.onWillSave(buffer.editorconfig.onWillSave.bind(buffer.editorconfig)));
		if (buffer.getUri() && buffer.getUri().match(/[\\|/]\.editorconfig$/g) !== null) {
			buffer.editorconfig.disposables.add(buffer.onDidSave(reapplyEditorconfig));
		}
	}
}

// Reveal and apply the editorconfig for the given TextEditor-instance
function observeTextEditor(editor) {
	if (!editor) {
		return;
	}
	initializeTextBuffer(editor.getBuffer());

	var file = editor.getURI();
	if (!file) {
		editor.onDidSave(function () {
			observeTextEditor(editor);
		});
		return;
	}

	editorconfig().parse(file).then(function (config) {
		if (Object.keys(config).length === 0) {
			return;
		}

		var ecfg = editor.getBuffer().editorconfig;
		var settings = ecfg.settings;
		var lineEndings = {
			crlf: '\r\n',
			cr: '\r',
			lf: '\n'
		};

		// Preserve evaluated Editorconfig
		ecfg.config = config;

		// Carefully normalize and initialize config-settings
		// eslint-disable-next-line camelcase
		settings.trim_trailing_whitespace = 'trim_trailing_whitespace' in config && typeof config.trim_trailing_whitespace === 'boolean' ? config.trim_trailing_whitespace === true : 'auto';

		// eslint-disable-next-line camelcase
		settings.insert_final_newline = 'insert_final_newline' in config && typeof config.insert_final_newline === 'boolean' ? config.insert_final_newline === true : 'auto';

		// eslint-disable-next-line camelcase
		settings.indent_style = 'indent_style' in config && config.indent_style.search(/^(space|tab)$/) > -1 ? config.indent_style : 'auto';

		// eslint-disable-next-line camelcase
		settings.end_of_line = lineEndings[config.end_of_line] || 'auto';

		// eslint-disable-next-line camelcase
		settings.tab_width = parseInt(config.indent_size || config.tab_width, 10);
		if (isNaN(settings.tab_width) || settings.tab_width <= 0) {
			settings.tab_width = 'auto'; // eslint-disable-line camelcase
		}

		// eslint-disable-next-line camelcase
		settings.max_line_length = parseInt(config.max_line_length, 10);
		if (isNaN(settings.max_line_length)) {
			settings.max_line_length = 'auto'; // eslint-disable-line camelcase
		}

		settings.charset = 'charset' in config ? config.charset.replace(/-/g, '').toLowerCase() : 'auto';

		ecfg.applySettings();
	})['catch'](Error, function (e) {
		console.warn('atom-editorconfig: ' + e);
	});
}

// Reapplies the whole editorconfig to **all** open TextEditor-instances
function reapplyEditorconfig() {
	var textEditors = atom.workspace.getTextEditors();
	textEditors.forEach(function (editor) {
		observeTextEditor(editor);
	});
}

// Reapplies the settings immediately after changing the focus to a new pane
function observeActivePaneItem(editor) {
	if (editor && editor.constructor.name === 'TextEditor') {
		if (editor.getBuffer().editorconfig) {
			editor.getBuffer().editorconfig.applySettings();
		}
	} else {
		statusTile().removeIcon();
	}
}

// Hook into the events to recognize the user opening new editors or changing the pane
var activate = function activate() {
	(0, _commandsGenerate2['default'])();
	(0, _commandsShow2['default'])();
	(0, _commandsFix2['default'])();
	atom.workspace.observeTextEditors(observeTextEditor);
	atom.workspace.observeActivePaneItem(observeActivePaneItem);
};

// Clean the status-icon up, remove all embedded editorconfig-objects
var deactivate = function deactivate() {
	var textEditors = atom.workspace.getTextEditors();
	textEditors.forEach(function (editor) {
		editor.getBuffer().editorconfig.disposables.dispose();
	});
	statusTile().removeIcon();
};

// Apply the statusbar icon-container
// The icon will be applied if needed
var consumeStatusBar = function consumeStatusBar(statusBar) {
	if (statusTile().containerExists() === false) {
		statusBar.addRightTile({
			item: statusTile().createContainer(),
			priority: 999
		});
	}
};

exports['default'] = { activate: activate, deactivate: deactivate, consumeStatusBar: consumeStatusBar };
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3N0ZWZhbm8vLmRvdGZpbGVzL2F0b20uc3ltbGluay9wYWNrYWdlcy9lZGl0b3Jjb25maWcvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Z0NBQzJCLHFCQUFxQjs7Ozs0QkFDMUIsaUJBQWlCOzs7OzJCQUNuQixnQkFBZ0I7Ozs7QUFFcEMsSUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDOztBQUU3QyxJQUFNLEdBQUcsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7O0FBRTVCLElBQU0sVUFBVSxHQUFHLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO0FBQ3BELElBQU0sU0FBUyxHQUFHLE9BQU8sQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO0FBQ2xELElBQU0sWUFBWSxHQUFHLE9BQU8sQ0FBQyxjQUFjLENBQUMsQ0FBQzs7QUFFN0MsSUFBTSxNQUFNLEdBQUcsQ0FBQyxRQUFRLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsT0FBTyxDQUFDLENBQUM7Ozs7QUFJakUsSUFBTSxvQkFBb0IsR0FBRztBQUM1QixXQUFVLEVBQUUsQ0FBQyxzQkFBc0IsRUFBRSwwQkFBMEIsQ0FBQztDQUNoRSxDQUFDOzs7O0FBSUYsU0FBUyxRQUFRLENBQUMsSUFBSSxFQUFFO0FBQ3ZCLEtBQU0sUUFBUSxHQUFHLEVBQUUsQ0FBQztBQUNwQixLQUFJLE9BQU8sR0FBRyxDQUFDLENBQUM7OztBQUdoQixLQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxVQUFDLElBQUksRUFBRSxJQUFJLEVBQUs7QUFDckQsU0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxLQUFLLE1BQU0sSUFBSSxJQUFJLENBQUM7RUFDOUMsRUFBRSxLQUFLLENBQUMsRUFBRTtBQUNWLFNBQU8sR0FBRyxJQUFJLENBQUMsR0FB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QzFCLENBQUM7Ozs7QUFJRixJQUFNLGdCQUFnQixHQUFHLFNBQW5CLGdCQUFnQixDQUFHLFNBQVMsRUFBSTtBQUNyQyxLQUFJLFVBQVUsRUFBRSxDQUFDLGVBQWUsRUFBRSxLQUFLLEtBQUssRUFBRTtBQUM3QyxXQUFTLENBQUMsWUFBWSxDQUFDO0FBQ3RCLE9BQUksRUFBRSxVQUFVLEVBQUUsQ0FBQyxlQUFlLEVBQUU7QUFDcEMsV0FBUSxFQUFFLEdBQUc7R0FDYixDQUFDLENBQUM7RUFDSDtDQUNELENBQUM7O3FCQUVhLEVBQUMsUUFBUSxFQUFSLFFBQVEsRUFBRSxVQUFVLEVBQVYsVUFBVSxFQUFFLGdCQUFnQixFQUFoQixnQkFBZ0IsRUFBQyIsImZpbGUiOiIvaG9tZS9zdGVmYW5vLy5kb3RmaWxlcy9hdG9tLnN5bWxpbmsvcGFja2FnZXMvZWRpdG9yY29uZmlnL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqIEBiYWJlbCAqL1xuaW1wb3J0IGdlbmVyYXRlQ29uZmlnIGZyb20gJy4vY29tbWFuZHMvZ2VuZXJhdGUnO1xuaW1wb3J0IHNob3dTdGF0ZSBmcm9tICcuL2NvbW1hbmRzL3Nob3cnO1xuaW1wb3J0IGZpeEZpbGUgZnJvbSAnLi9jb21tYW5kcy9maXgnO1xuXG5jb25zdCBsYXp5UmVxID0gcmVxdWlyZSgnbGF6eS1yZXEnKShyZXF1aXJlKTtcblxuY29uc3QgYXRtID0gbGF6eVJlcSgnYXRvbScpO1xuXG5jb25zdCBzdGF0dXNUaWxlID0gbGF6eVJlcSgnLi9saWIvc3RhdHVzdGlsZS12aWV3Jyk7XG5jb25zdCB3cmFwR3VpZGUgPSBsYXp5UmVxKCcuL2xpYi93cmFwZ3VpZGUtdmlldycpO1xuY29uc3QgZWRpdG9yY29uZmlnID0gbGF6eVJlcSgnZWRpdG9yY29uZmlnJyk7XG5cbmNvbnN0IFNUQVRFUyA9IFsnc3VidGxlJywgJ3N1Y2Nlc3MnLCAnaW5mbycsICd3YXJuaW5nJywgJ2Vycm9yJ107XG5cbi8vIEhvbGRzIGFsbCAqKmJsYWNrbGlzdGVkKiogcGFja2FnZXMgYW5kIHRoZSBwcm9wZXJ0aWVzIHdlIGFzc3VtZSBhcmUgYWZmZWN0ZWQgYnkgdGhlbVxuLy8gJ3BhY2thZ2VuYW1lJzogW3Byb3BlcnRpZXNdXG5jb25zdCBCTEFDS0xJU1RFRF9QQUNLQUdFUyA9IHtcblx0d2hpdGVzcGFjZTogWydpbnNlcnRfZmluYWxfbmV3bGluZScsICd0cmltX3RyYWlsaW5nX3doaXRlc3BhY2UnXVxufTtcblxuLy8gU2V0cyB0aGUgc3RhdGUgb2YgdGhlIGVtYmVkZGVkIGVkaXRvcmNvbmZpZ1xuLy8gVGhpcyBpbmNsdWRlcyB0aGUgc2V2ZXJpdHkgKGluZm8sIHdhcm5pbmcuLikgYXMgd2VsbCBhcyB0aGUgbm90aWZpY2F0aW9uLW1lc3NhZ2VzIGZvciB1c2Vyc1xuZnVuY3Rpb24gc2V0U3RhdGUoZWNmZykge1xuXHRjb25zdCBtZXNzYWdlcyA9IFtdO1xuXHRsZXQgc3RhdGNvbiA9IDA7XG5cblx0Ly8gQ2hlY2sgaWYgYW55IGVkaXRvcmNvbmZpZy1zZXR0aW5nIGlzIGluIHVzZVxuXHRpZiAoT2JqZWN0LmtleXMoZWNmZy5zZXR0aW5ncykucmVkdWNlKChwcmV2LCBjdXJyKSA9PiB7XG5cdFx0cmV0dXJuIGVjZmcuc2V0dGluZ3NbY3Vycl0gIT09ICdhdXRvJyB8fCBwcmV2O1xuXHR9LCBmYWxzZSkpIHtcblx0XHRzdGF0Y29uID0gTWF0aC5tYXgoc3RhdGNvbiwgMSk7XG5cdH1cblxuXHQvLyBDaGVjayB0aGUgJ1RhYiBUeXBlJy1zZXR0aW5nXG5cdGlmIChlY2ZnLnNldHRpbmdzLmluZGVudF9zdHlsZSAhPT0gJ2F1dG8nICYmXG5cdFx0YXRvbS5jb25maWcuZ2V0KCdlZGl0b3IudGFiVHlwZScpICE9PSAnYXV0bycpIHtcblx0XHRjb25zdCB0YWJUeXBlID0gYXRvbS5jb25maWcuZ2V0KCdlZGl0b3IudGFiVHlwZScpO1xuXG5cdFx0bWVzc2FnZXMucHVzaChgKipUYWIgVHlwZToqKiBZb3UgZWRpdG9yJ3MgY29uZmlndXJhdGlvbiBzZXR0aW5nIFwiVGFiIFR5cGVcIlxuXHRcdChjdXJyZW50bHkgXCIke3RhYlR5cGV9XCIgcHJldmVudHMgdGhlIGVkaXRvcmNvbmZpZy1wcm9wZXJ0eSBcXGBpbmRlbnRfc3R5bGVcXGAgZnJvbSB3b3JraW5nLlxuXHRcdEBcIlRhYiBUeXBlXCIgKiptdXN0KiogYmUgc2V0IHRvIFwiYXV0b1wiIHRvIGZpeCB0aGlzIGlzc3VlLmApO1xuXG5cdFx0c3RhdGNvbiA9IE1hdGgubWF4KHN0YXRjb24sIDQpO1xuXHR9XG5cblx0Ly8gQ2hlY2sgZm9yIEJMQUNLTElTVEVEIHBhY2thZ2VzXG5cdGNvbnN0IHN1c3BpY2l1b3VzUGFja2FnZXMgPSB7fTtcblx0bGV0IGFmZmVjdGVkUHJvcGVydGllcztcblx0Zm9yIChjb25zdCBwYWNrYWdlTmFtZSBpbiBCTEFDS0xJU1RFRF9QQUNLQUdFUykge1xuXHRcdGlmICh7fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKEJMQUNLTElTVEVEX1BBQ0tBR0VTLCBwYWNrYWdlTmFtZSkpIHtcblx0XHRcdGFmZmVjdGVkUHJvcGVydGllcyA9IEJMQUNLTElTVEVEX1BBQ0tBR0VTW3BhY2thZ2VOYW1lXS5maWx0ZXIocHJvcCA9PiB7XG5cdFx0XHRcdHJldHVybiBlY2ZnLnNldHRpbmdzW3Byb3BdICE9PSAnYXV0byc7XG5cdFx0XHR9KTtcblx0XHRcdGlmIChhZmZlY3RlZFByb3BlcnRpZXMubGVuZ3RoID4gMCAmJlxuXHRcdFx0XHRhdG9tLnBhY2thZ2VzLmlzUGFja2FnZUFjdGl2ZShwYWNrYWdlTmFtZSkpIHtcblx0XHRcdFx0c3VzcGljaXVvdXNQYWNrYWdlc1twYWNrYWdlTmFtZV0gPSBhZmZlY3RlZFByb3BlcnRpZXM7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdGlmIChPYmplY3Qua2V5cyhzdXNwaWNpdW91c1BhY2thZ2VzKS5sZW5ndGggPiAwKSB7XG5cdFx0Zm9yIChjb25zdCBwYWNrYWdlTmFtZSBpbiBzdXNwaWNpdW91c1BhY2thZ2VzKSB7XG5cdFx0XHRpZiAoe30uaGFzT3duUHJvcGVydHkuY2FsbChzdXNwaWNpdW91c1BhY2thZ2VzLCBwYWNrYWdlTmFtZSkpIHtcblx0XHRcdFx0Y29uc3QgcHJvcGVydGllcyA9IHN1c3BpY2l1b3VzUGFja2FnZXNbcGFja2FnZU5hbWVdO1xuXHRcdFx0XHRtZXNzYWdlcy5wdXNoKGAqKiR7cGFja2FnZU5hbWV9OioqIEl0IGlzIGxpa2VseSB0aGF0IHRoZVxuXHRcdFx0XHQke3BhY2thZ2VOYW1lfS1wYWNrYWdlIHByZXZlbnRzIHRoZSBmb2xsb3dpbmdcblx0XHRcdFx0cHJvcGVydCR7cHJvcGVydGllcy5sZW5ndGggPiAxID8gJ2llcycgOiAneSd9IGZyb20gd29ya2luZyByZWxpYWJseTpcblx0XHRcdFx0XFxgJHtwcm9wZXJ0aWVzLmpvaW4oJ2AsIGAnKX1cXGAuQFlvdSBtYXkgZGVhY3RpdmF0ZSBvciBkaXNhYmxlIHRoZSAke3BhY2thZ2VOYW1lfS1wYWNrYWdlXG5cdFx0XHRcdHRvIGZpeCB0aGF0IGlzc3VlLmApO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRzdGF0Y29uID0gTWF0aC5tYXgoc3RhdGNvbiwgMyk7XG5cdH1cblxuXHRzd2l0Y2ggKHN0YXRjb24pIHtcblx0XHRjYXNlIDE6XG5cdFx0XHRtZXNzYWdlcy5wdXNoKGBUaGUgZWRpdG9yY29uZmlnIHdhcyBhcHBsaWVkIHN1Y2Nlc3NmdWxseSBhbmQgdGhlIGVkaXRvciBmb3IgdGhpcyBmaWxlXG5cdFx0XHRzaG91bGQgd29yayBhcyBleHBlY3RlZC4gSWYgeW91IGZhY2UgYW55IHVuZXhwZWN0ZWQgYmVoYXZpb3IgcGxlYXNlIHJlcG9ydCB1cyB0aGUgaXNzdWUuXG5cdFx0XHTimaXvuI9gKTtcblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgMDpcblx0XHRcdG1lc3NhZ2VzLnB1c2goYEZvciB0aGlzIGZpbGUgd2VyZSBubyBlZGl0b3Jjb25maWctc2V0dGluZ3MgYXBwbGllZC5gKTtcblx0XHRcdGJyZWFrO1xuXHRcdGRlZmF1bHQ6XG5cdFx0XHRicmVhaztcblx0fVxuXG5cdC8vIEFwcGx5IGNoYW5nZXNcblx0ZWNmZy5tZXNzYWdlcyA9IG1lc3NhZ2VzO1xuXHRlY2ZnLnN0YXRlID0gU1RBVEVTW3N0YXRjb25dO1xuXHRzdGF0dXNUaWxlKCkudXBkYXRlSWNvbihlY2ZnLnN0YXRlKTtcbn1cblxuLy8gSW5pdGlhbGl6ZXMgdGhlIChpbnRvIHRoZSBUZXh0QnVmZmVyLWluc3RhbmNlKSBlbWJlZGRlZCBlZGl0b3Jjb25maWctb2JqZWN0XG5mdW5jdGlvbiBpbml0aWFsaXplVGV4dEJ1ZmZlcihidWZmZXIpIHtcblx0aWYgKCdlZGl0b3Jjb25maWcnIGluIGJ1ZmZlciA9PT0gZmFsc2UpIHtcblx0XHRidWZmZXIuZWRpdG9yY29uZmlnID0ge1xuXHRcdFx0YnVmZmVyLCAvLyBwcmVzZXJ2aW5nIGEgcmVmZXJlbmNlIHRvIHRoZSBwYXJlbnQgVGV4dEJ1ZmZlclxuXHRcdFx0ZGlzcG9zYWJsZXM6IG5ldyAoYXRtKCkuQ29tcG9zaXRlRGlzcG9zYWJsZSkoKSxcblx0XHRcdHN0YXRlOiAnc3VidGxlJyxcblx0XHRcdHNldHRpbmdzOiB7XG5cdFx0XHRcdHRyaW1fdHJhaWxpbmdfd2hpdGVzcGFjZTogJ2F1dG8nLCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGNhbWVsY2FzZVxuXHRcdFx0XHRpbnNlcnRfZmluYWxfbmV3bGluZTogJ2F1dG8nLCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGNhbWVsY2FzZVxuXHRcdFx0XHRtYXhfbGluZV9sZW5ndGg6ICdhdXRvJywgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjYW1lbGNhc2Vcblx0XHRcdFx0ZW5kX29mX2xpbmU6ICdhdXRvJywgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjYW1lbGNhc2Vcblx0XHRcdFx0aW5kZW50X3N0eWxlOiAnYXV0bycsIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgY2FtZWxjYXNlXG5cdFx0XHRcdHRhYl93aWR0aDogJ2F1dG8nLCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGNhbWVsY2FzZVxuXHRcdFx0XHRjaGFyc2V0OiAnYXV0bycgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjYW1lbGNhc2Vcblx0XHRcdH0sXG5cblx0XHRcdC8vIFNldHMgdGhlIGdpdmVuIHBhY2thZ2UgYWN0aXZlIG9yIGluYWN0aXZlXG5cdFx0XHRzZXRQYWNrYWdlU3RhdGUobmFtZSwgYWN0aXZlKSB7XG5cdFx0XHRcdGlmIChhdG9tLnBhY2thZ2VzLmlzUGFja2FnZURpc2FibGVkKG5hbWUpID09PSBmYWxzZSAmJlxuXHRcdFx0XHRcdGF0b20ucGFja2FnZXMuaXNQYWNrYWdlQWN0aXZlKG5hbWUpICE9PSBhY3RpdmUpIHtcblx0XHRcdFx0XHRpZiAoYWN0aXZlID09PSB0cnVlKSB7XG5cdFx0XHRcdFx0XHRhdG9tLnBhY2thZ2VzLmFjdGl2YXRlUGFja2FnZShuYW1lKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0YXRvbS5wYWNrYWdlcy5kZWFjdGl2YXRlUGFja2FnZShuYW1lKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdC8vIEFwcGxpZXMgdGhlIHNldHRpbmdzIHRvIHRoZSBidWZmZXIgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGVkaXRvclxuXHRcdFx0YXBwbHlTZXR0aW5ncygpIHtcblx0XHRcdFx0Y29uc3QgZWRpdG9yID0gYXRvbS53b3Jrc3BhY2UuZ2V0VGV4dEVkaXRvcnMoKS5yZWR1Y2UoKHByZXYsIGN1cnIpID0+IHtcblx0XHRcdFx0XHRyZXR1cm4gKGN1cnIuZ2V0QnVmZmVyKCkgPT09IGJ1ZmZlciAmJiBjdXJyKSB8fCBwcmV2O1xuXHRcdFx0XHR9LCB1bmRlZmluZWQpO1xuXHRcdFx0XHRpZiAoIWVkaXRvcikge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNvbnN0IGNvbmZpZ09wdGlvbnMgPSB7c2NvcGU6IGVkaXRvci5nZXRSb290U2NvcGVEZXNjcmlwdG9yKCl9O1xuXHRcdFx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMuc2V0dGluZ3M7XG5cblx0XHRcdFx0aWYgKGVkaXRvciAmJiBlZGl0b3IuZ2V0QnVmZmVyKCkgPT09IGJ1ZmZlcikge1xuXHRcdFx0XHRcdGlmIChzZXR0aW5ncy5pbmRlbnRfc3R5bGUgPT09ICdhdXRvJykge1xuXHRcdFx0XHRcdFx0ZWRpdG9yLnNldFNvZnRUYWJzKGF0b20uY29uZmlnLmdldCgnZWRpdG9yLnNvZnRUYWJzJywgY29uZmlnT3B0aW9ucykpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRlZGl0b3Iuc2V0U29mdFRhYnMoc2V0dGluZ3MuaW5kZW50X3N0eWxlID09PSAnc3BhY2UnKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoc2V0dGluZ3MudGFiX3dpZHRoID09PSAnYXV0bycpIHtcblx0XHRcdFx0XHRcdGVkaXRvci5zZXRUYWJMZW5ndGgoYXRvbS5jb25maWcuZ2V0KCdlZGl0b3IudGFiTGVuZ3RoJywgY29uZmlnT3B0aW9ucykpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRlZGl0b3Iuc2V0VGFiTGVuZ3RoKHNldHRpbmdzLnRhYl93aWR0aCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKHNldHRpbmdzLmNoYXJzZXQgPT09ICdhdXRvJykge1xuXHRcdFx0XHRcdFx0YnVmZmVyLnNldEVuY29kaW5nKGF0b20uY29uZmlnLmdldCgnY29yZS5maWxlRW5jb2RpbmcnLCBjb25maWdPcHRpb25zKSk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGJ1ZmZlci5zZXRFbmNvZGluZyhzZXR0aW5ncy5jaGFyc2V0KTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBtYXhfbGluZV9sZW5ndGgtc2V0dGluZ3Ncblx0XHRcdFx0XHRjb25zdCBlZGl0b3JQYXJhbXMgPSB7fTtcblx0XHRcdFx0XHRpZiAoc2V0dGluZ3MubWF4X2xpbmVfbGVuZ3RoID09PSAnYXV0bycpIHtcblx0XHRcdFx0XHRcdGVkaXRvclBhcmFtcy5zb2Z0V3JhcHBlZCA9IGF0b20uY29uZmlnLmdldCgnZWRpdG9yLnNvZnRXcmFwJywgY29uZmlnT3B0aW9ucyk7XG5cdFx0XHRcdFx0XHRlZGl0b3JQYXJhbXMuc29mdFdyYXBBdFByZWZlcnJlZExpbmVMZW5ndGggPVxuXHRcdFx0XHRcdFx0XHRhdG9tLmNvbmZpZy5nZXQoJ2VkaXRvci5zb2Z0V3JhcEF0UHJlZmVycmVkTGluZUxlbmd0aCcsIGNvbmZpZ09wdGlvbnMpO1xuXHRcdFx0XHRcdFx0ZWRpdG9yUGFyYW1zLnByZWZlcnJlZExpbmVMZW5ndGggPVxuXHRcdFx0XHRcdFx0XHRhdG9tLmNvbmZpZy5nZXQoJ2VkaXRvci5wcmVmZXJyZWRMaW5lTGVuZ3RoJywgY29uZmlnT3B0aW9ucyk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGVkaXRvclBhcmFtcy5zb2Z0V3JhcHBlZCA9IHRydWU7XG5cdFx0XHRcdFx0XHRlZGl0b3JQYXJhbXMuc29mdFdyYXBBdFByZWZlcnJlZExpbmVMZW5ndGggPSB0cnVlO1xuXHRcdFx0XHRcdFx0ZWRpdG9yUGFyYW1zLnByZWZlcnJlZExpbmVMZW5ndGggPSBzZXR0aW5ncy5tYXhfbGluZV9sZW5ndGg7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gVXBkYXRlIHRoZSBlZGl0b3ItcHJvcGVydGllc1xuXHRcdFx0XHRcdGVkaXRvci51cGRhdGUoZWRpdG9yUGFyYW1zKTtcblxuXHRcdFx0XHRcdC8vIEVuc3VyZSB0aGUgd3JhcC1ndWlkZSBpcyBzZXQgcHJvcGVybHlcblx0XHRcdFx0XHRpZiAodGhpcy53cmFwR3VpZGUgPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdFx0dGhpcy53cmFwR3VpZGUgPSBuZXcgKHdyYXBHdWlkZSgpKSgpO1xuXHRcdFx0XHRcdFx0dGhpcy53cmFwR3VpZGUuaW5pdGlhbGl6ZShcblx0XHRcdFx0XHRcdFx0ZWRpdG9yLFxuXHRcdFx0XHRcdFx0XHRhdG9tLnZpZXdzLmdldFZpZXcoZWRpdG9yKVxuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dGhpcy53cmFwR3VpZGUudXBkYXRlKCk7XG5cdFx0XHRcdFx0Ly8gVG9nZ2xlIHRoZSB3cmFwLWd1aWRlIHBhY2thZ2UgaWYgbmVjZXNzYXJ5XG5cdFx0XHRcdFx0dGhpcy5zZXRQYWNrYWdlU3RhdGUoJ3dyYXAtZ3VpZGUnLCB0aGlzLndyYXBHdWlkZS5pc1Zpc2libGUoKSA9PT0gZmFsc2UpO1xuXG5cdFx0XHRcdFx0aWYgKHNldHRpbmdzLmVuZF9vZl9saW5lICE9PSAnYXV0bycpIHtcblx0XHRcdFx0XHRcdGJ1ZmZlci5zZXRQcmVmZXJyZWRMaW5lRW5kaW5nKHNldHRpbmdzLmVuZF9vZl9saW5lKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0c2V0U3RhdGUodGhpcyk7XG5cdFx0XHR9LFxuXG5cdFx0XHQvLyBvbldpbGxTYXZlLUV2ZW50LUhhbmRsZXJcblx0XHRcdC8vIFRyaW1zIHdoaXRlc3BhY2VzIGFuZCBpbnNlcnRzL3N0cmlwcyBmaW5hbCBuZXdsaW5lIGJlZm9yZSBzYXZpbmdcblx0XHRcdG9uV2lsbFNhdmUoKSB7XG5cdFx0XHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5zZXR0aW5ncztcblxuXHRcdFx0XHRpZiAoc2V0dGluZ3MudHJpbV90cmFpbGluZ193aGl0ZXNwYWNlID09PSB0cnVlKSB7XG5cdFx0XHRcdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1wYXJhbXNcblx0XHRcdFx0XHRidWZmZXIuYmFja3dhcmRzU2NhbigvWyBcXHRdKyQvZ20sIHBhcmFtcyA9PiB7XG5cdFx0XHRcdFx0XHRpZiAocGFyYW1zLm1hdGNoWzBdLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0cGFyYW1zLnJlcGxhY2UoJycpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKHNldHRpbmdzLmluc2VydF9maW5hbF9uZXdsaW5lICE9PSAnYXV0bycpIHtcblx0XHRcdFx0XHRjb25zdCBsYXN0Um93ID0gYnVmZmVyLmdldExpbmVDb3VudCgpIC0gMTtcblxuXHRcdFx0XHRcdGlmIChidWZmZXIuaXNSb3dCbGFuayhsYXN0Um93KSkge1xuXHRcdFx0XHRcdFx0bGV0IHN0cmlwU3RhcnQgPSBidWZmZXIucHJldmlvdXNOb25CbGFua1JvdyhsYXN0Um93KTtcblxuXHRcdFx0XHRcdFx0aWYgKHNldHRpbmdzLmluc2VydF9maW5hbF9uZXdsaW5lID09PSB0cnVlKSB7XG5cdFx0XHRcdFx0XHRcdHN0cmlwU3RhcnQgKz0gMTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdC8vIFN0cmlwIGVtcHR5IGxpbmVzIGZyb20gdGhlIGVuZFxuXHRcdFx0XHRcdFx0aWYgKHN0cmlwU3RhcnQgPCBsYXN0Um93KSB7XG5cdFx0XHRcdFx0XHRcdGJ1ZmZlci5kZWxldGVSb3dzKHN0cmlwU3RhcnQgKyAxLCBsYXN0Um93KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGVsc2UgaWYgKHNldHRpbmdzLmluc2VydF9maW5hbF9uZXdsaW5lID09PSB0cnVlKSB7XG5cdFx0XHRcdFx0XHRidWZmZXIuYXBwZW5kKCdcXG4nKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0YnVmZmVyLmVkaXRvcmNvbmZpZy5kaXNwb3NhYmxlcy5hZGQoXG5cdFx0XHRidWZmZXIub25XaWxsU2F2ZShidWZmZXIuZWRpdG9yY29uZmlnLm9uV2lsbFNhdmUuYmluZChidWZmZXIuZWRpdG9yY29uZmlnKSlcblx0XHQpO1xuXHRcdGlmIChidWZmZXIuZ2V0VXJpKCkgJiYgYnVmZmVyLmdldFVyaSgpLm1hdGNoKC9bXFxcXHwvXVxcLmVkaXRvcmNvbmZpZyQvZykgIT09IG51bGwpIHtcblx0XHRcdGJ1ZmZlci5lZGl0b3Jjb25maWcuZGlzcG9zYWJsZXMuYWRkKFxuXHRcdFx0XHRidWZmZXIub25EaWRTYXZlKHJlYXBwbHlFZGl0b3Jjb25maWcpXG5cdFx0XHQpO1xuXHRcdH1cblx0fVxufVxuXG4vLyBSZXZlYWwgYW5kIGFwcGx5IHRoZSBlZGl0b3Jjb25maWcgZm9yIHRoZSBnaXZlbiBUZXh0RWRpdG9yLWluc3RhbmNlXG5mdW5jdGlvbiBvYnNlcnZlVGV4dEVkaXRvcihlZGl0b3IpIHtcblx0aWYgKCFlZGl0b3IpIHtcblx0XHRyZXR1cm47XG5cdH1cblx0aW5pdGlhbGl6ZVRleHRCdWZmZXIoZWRpdG9yLmdldEJ1ZmZlcigpKTtcblxuXHRjb25zdCBmaWxlID0gZWRpdG9yLmdldFVSSSgpO1xuXHRpZiAoIWZpbGUpIHtcblx0XHRlZGl0b3Iub25EaWRTYXZlKCgpID0+IHtcblx0XHRcdG9ic2VydmVUZXh0RWRpdG9yKGVkaXRvcik7XG5cdFx0fSk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0ZWRpdG9yY29uZmlnKCkucGFyc2UoZmlsZSkudGhlbihjb25maWcgPT4ge1xuXHRcdGlmIChPYmplY3Qua2V5cyhjb25maWcpLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGNvbnN0IGVjZmcgPSBlZGl0b3IuZ2V0QnVmZmVyKCkuZWRpdG9yY29uZmlnO1xuXHRcdGNvbnN0IHNldHRpbmdzID0gZWNmZy5zZXR0aW5ncztcblx0XHRjb25zdCBsaW5lRW5kaW5ncyA9IHtcblx0XHRcdGNybGY6ICdcXHJcXG4nLFxuXHRcdFx0Y3I6ICdcXHInLFxuXHRcdFx0bGY6ICdcXG4nXG5cdFx0fTtcblxuXHRcdC8vIFByZXNlcnZlIGV2YWx1YXRlZCBFZGl0b3Jjb25maWdcblx0XHRlY2ZnLmNvbmZpZyA9IGNvbmZpZztcblxuXHRcdC8vIENhcmVmdWxseSBub3JtYWxpemUgYW5kIGluaXRpYWxpemUgY29uZmlnLXNldHRpbmdzXG5cdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZVxuXHRcdHNldHRpbmdzLnRyaW1fdHJhaWxpbmdfd2hpdGVzcGFjZSA9ICgndHJpbV90cmFpbGluZ193aGl0ZXNwYWNlJyBpbiBjb25maWcpICYmXG5cdFx0XHR0eXBlb2YgY29uZmlnLnRyaW1fdHJhaWxpbmdfd2hpdGVzcGFjZSA9PT0gJ2Jvb2xlYW4nID9cblx0XHRcdGNvbmZpZy50cmltX3RyYWlsaW5nX3doaXRlc3BhY2UgPT09IHRydWUgOlxuXHRcdFx0J2F1dG8nO1xuXG5cdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZVxuXHRcdHNldHRpbmdzLmluc2VydF9maW5hbF9uZXdsaW5lID0gKCdpbnNlcnRfZmluYWxfbmV3bGluZScgaW4gY29uZmlnKSAmJlxuXHRcdFx0dHlwZW9mIGNvbmZpZy5pbnNlcnRfZmluYWxfbmV3bGluZSA9PT0gJ2Jvb2xlYW4nID9cblx0XHRcdGNvbmZpZy5pbnNlcnRfZmluYWxfbmV3bGluZSA9PT0gdHJ1ZSA6XG5cdFx0XHQnYXV0byc7XG5cblx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG5cdFx0c2V0dGluZ3MuaW5kZW50X3N0eWxlID0gKCgnaW5kZW50X3N0eWxlJyBpbiBjb25maWcpICYmXG5cdFx0XHRjb25maWcuaW5kZW50X3N0eWxlLnNlYXJjaCgvXihzcGFjZXx0YWIpJC8pID4gLTEpID9cblx0XHRcdGNvbmZpZy5pbmRlbnRfc3R5bGUgOlxuXHRcdFx0J2F1dG8nO1xuXG5cdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZVxuXHRcdHNldHRpbmdzLmVuZF9vZl9saW5lID0gbGluZUVuZGluZ3NbY29uZmlnLmVuZF9vZl9saW5lXSB8fCAnYXV0byc7XG5cblx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG5cdFx0c2V0dGluZ3MudGFiX3dpZHRoID0gcGFyc2VJbnQoY29uZmlnLmluZGVudF9zaXplIHx8IGNvbmZpZy50YWJfd2lkdGgsIDEwKTtcblx0XHRpZiAoaXNOYU4oc2V0dGluZ3MudGFiX3dpZHRoKSB8fCBzZXR0aW5ncy50YWJfd2lkdGggPD0gMCkge1xuXHRcdFx0c2V0dGluZ3MudGFiX3dpZHRoID0gJ2F1dG8nOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGNhbWVsY2FzZVxuXHRcdH1cblxuXHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjYW1lbGNhc2Vcblx0XHRzZXR0aW5ncy5tYXhfbGluZV9sZW5ndGggPSBwYXJzZUludChjb25maWcubWF4X2xpbmVfbGVuZ3RoLCAxMCk7XG5cdFx0aWYgKGlzTmFOKHNldHRpbmdzLm1heF9saW5lX2xlbmd0aCkpIHtcblx0XHRcdHNldHRpbmdzLm1heF9saW5lX2xlbmd0aCA9ICdhdXRvJzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjYW1lbGNhc2Vcblx0XHR9XG5cblx0XHRzZXR0aW5ncy5jaGFyc2V0ID0gKCdjaGFyc2V0JyBpbiBjb25maWcpID9cblx0XHRcdGNvbmZpZy5jaGFyc2V0LnJlcGxhY2UoLy0vZywgJycpLnRvTG93ZXJDYXNlKCkgOlxuXHRcdFx0J2F1dG8nO1xuXG5cdFx0ZWNmZy5hcHBseVNldHRpbmdzKCk7XG5cdH0pLmNhdGNoKEVycm9yLCBlID0+IHtcblx0XHRjb25zb2xlLndhcm4oYGF0b20tZWRpdG9yY29uZmlnOiAke2V9YCk7XG5cdH0pO1xufVxuXG4vLyBSZWFwcGxpZXMgdGhlIHdob2xlIGVkaXRvcmNvbmZpZyB0byAqKmFsbCoqIG9wZW4gVGV4dEVkaXRvci1pbnN0YW5jZXNcbmZ1bmN0aW9uIHJlYXBwbHlFZGl0b3Jjb25maWcoKSB7XG5cdGNvbnN0IHRleHRFZGl0b3JzID0gYXRvbS53b3Jrc3BhY2UuZ2V0VGV4dEVkaXRvcnMoKTtcblx0dGV4dEVkaXRvcnMuZm9yRWFjaChlZGl0b3IgPT4ge1xuXHRcdG9ic2VydmVUZXh0RWRpdG9yKGVkaXRvcik7XG5cdH0pO1xufVxuXG4vLyBSZWFwcGxpZXMgdGhlIHNldHRpbmdzIGltbWVkaWF0ZWx5IGFmdGVyIGNoYW5naW5nIHRoZSBmb2N1cyB0byBhIG5ldyBwYW5lXG5mdW5jdGlvbiBvYnNlcnZlQWN0aXZlUGFuZUl0ZW0oZWRpdG9yKSB7XG5cdGlmIChlZGl0b3IgJiYgZWRpdG9yLmNvbnN0cnVjdG9yLm5hbWUgPT09ICdUZXh0RWRpdG9yJykge1xuXHRcdGlmIChlZGl0b3IuZ2V0QnVmZmVyKCkuZWRpdG9yY29uZmlnKSB7XG5cdFx0XHRlZGl0b3IuZ2V0QnVmZmVyKCkuZWRpdG9yY29uZmlnLmFwcGx5U2V0dGluZ3MoKTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0c3RhdHVzVGlsZSgpLnJlbW92ZUljb24oKTtcblx0fVxufVxuXG4vLyBIb29rIGludG8gdGhlIGV2ZW50cyB0byByZWNvZ25pemUgdGhlIHVzZXIgb3BlbmluZyBuZXcgZWRpdG9ycyBvciBjaGFuZ2luZyB0aGUgcGFuZVxuY29uc3QgYWN0aXZhdGUgPSAoKSA9PiB7XG5cdGdlbmVyYXRlQ29uZmlnKCk7XG5cdHNob3dTdGF0ZSgpO1xuXHRmaXhGaWxlKCk7XG5cdGF0b20ud29ya3NwYWNlLm9ic2VydmVUZXh0RWRpdG9ycyhvYnNlcnZlVGV4dEVkaXRvcik7XG5cdGF0b20ud29ya3NwYWNlLm9ic2VydmVBY3RpdmVQYW5lSXRlbShvYnNlcnZlQWN0aXZlUGFuZUl0ZW0pO1xufTtcblxuLy8gQ2xlYW4gdGhlIHN0YXR1cy1pY29uIHVwLCByZW1vdmUgYWxsIGVtYmVkZGVkIGVkaXRvcmNvbmZpZy1vYmplY3RzXG5jb25zdCBkZWFjdGl2YXRlID0gKCkgPT4ge1xuXHRjb25zdCB0ZXh0RWRpdG9ycyA9IGF0b20ud29ya3NwYWNlLmdldFRleHRFZGl0b3JzKCk7XG5cdHRleHRFZGl0b3JzLmZvckVhY2goZWRpdG9yID0+IHtcblx0XHRlZGl0b3IuZ2V0QnVmZmVyKCkuZWRpdG9yY29uZmlnLmRpc3Bvc2FibGVzLmRpc3Bvc2UoKTtcblx0fSk7XG5cdHN0YXR1c1RpbGUoKS5yZW1vdmVJY29uKCk7XG59O1xuXG4vLyBBcHBseSB0aGUgc3RhdHVzYmFyIGljb24tY29udGFpbmVyXG4vLyBUaGUgaWNvbiB3aWxsIGJlIGFwcGxpZWQgaWYgbmVlZGVkXG5jb25zdCBjb25zdW1lU3RhdHVzQmFyID0gc3RhdHVzQmFyID0+IHtcblx0aWYgKHN0YXR1c1RpbGUoKS5jb250YWluZXJFeGlzdHMoKSA9PT0gZmFsc2UpIHtcblx0XHRzdGF0dXNCYXIuYWRkUmlnaHRUaWxlKHtcblx0XHRcdGl0ZW06IHN0YXR1c1RpbGUoKS5jcmVhdGVDb250YWluZXIoKSxcblx0XHRcdHByaW9yaXR5OiA5OTlcblx0XHR9KTtcblx0fVxufTtcblxuZXhwb3J0IGRlZmF1bHQge2FjdGl2YXRlLCBkZWFjdGl2YXRlLCBjb25zdW1lU3RhdHVzQmFyfTtcbiJdfQ==
//# sourceURL=/home/stefano/.dotfiles/atom.symlink/packages/editorconfig/index.js
